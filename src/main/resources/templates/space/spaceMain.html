<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" >
<head>

<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>스페이스 메인 페이지</title>

<!-- Bootstrap core CSS -->
<link href="/space/vendor/bootstrap/css/bootstrap.min.css"
	rel="stylesheet">

<!-- Custom fonts for this template -->
<link
	href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900"
	rel="stylesheet">
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i"
	rel="stylesheet">
<link href="/space/vendor/devicons/css/devicons.min.css" rel="stylesheet">
	<link href="/space/vendor/simple-line-icons/css/simple-line-icons.css"
	rel="stylesheet">
	<!-- 글자 변경 추가 -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link href="/space/vendor/font-awesome/css/font-awesome.min.css"
		  rel="stylesheet">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap"
	rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Gothic+A1&display=swap"
	rel="stylesheet">

	<link rel="stylesheet"
		  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<!-- Custom styles for this template -->
<link href="/space/css/resume.min.css" rel="stylesheet">

<style>
body {
	font-family: 'Gothic A1', sans-serif;
}

.space-title {
	font-weight: bold;
	font-family: 'Nanum Gothic', sans-serif;
}

/* 상단 사이드바 */
.floBanPc1 {
	position: fixed;
	top: 35px; /* 윗쪽 끝에서부터의 거리 */
	right: 50%;
	margin-right: -920px; /* 가운데를 기준으로 오른쪽 거리 */
	z-index: 99;
}

/* 하단 사이드바 */
.floBanPc2 {
	position: fixed;
	top: 950px; /* 윗쪽 끝에서부터의 거리 */
	right: 50%;
	margin-right: -920px; /* 가운데를 기준으로 오른쪽 거리 */
	z-index: 99;
}
.my-auto {
	margin-left: 200px;
}
body::-webkit-scrollbar {
	display: none; /* Chrome, Safari, Opera*/
}

table {
	width: 100%;
	border: 1px solid #444444;
	border-collapse: collapse;
}
.table td {
	border-top : 1px solid #444444;
}
th, td {
	border: 1px solid #444444;
	padding: 10px;
}
.my-auto {
	width: 70%
}
blockquote {
	margin-left: 0px;
	margin-right: 0px;
	padding-left: 20px;
	padding-right: 20px;
	padding-top : 10px;
	padding-bottom : 10px;
	border-left: 10px solid #ccc;
}
blockquote p {
	margin-bottom: 0px;
}

img {
	width: 80%;
	height: 50%;
}


.media {
	display: block;
}
.text-center {

	width: 100%;
	height: 100%;
	display: none;
	bottom: 0;
	right: 0;
	background: rgba(0,0,0,0.3);
	z-index: 100;
	justify-content: center;
	align-items: center;
	margin: -30px 0 0 -30px;
	position: fixed;
}

.spinner-border {
	display: block;
	position: fixed;
	top : calc(50% - (250px /2));
	right: calc(50% - (250px /2));
	width: 10rem;
	height: 10rem;

	border: .25em solid #023476;
	border-right-color: transparent;
	border-radius: 50%;
	animation: spinner-border .75s linear infinite;
}

.category-top-margin {
	margin-top : 40px;
}

</style>

<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
	crossorigin="anonymous"></script>

	<!-- JS, Popper.js, and jQuery -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

	<!--pdf-->
	<script src="/js/html2canvas.js"></script>
	<script src="/js/jspdf.min.js"></script>
	<script src="/js/html2pdf.bundle.js"></script>
	<!--로딩바
	<script src="/js/loading.js"></script> -->
</head>

<body id="page-top">

	<nav class="navbar navbar-expand-lg navbar-dark bg-primary " id="sideNav" style="background: rgba(0,0,0,0.8)">
		<a class="navbar-brand js-scroll-trigger" href="#page-top" style="">
			<span class="d-block d-lg-none">space</span> <span class="d-none d-lg-block">


			<img
				class="img-fluid img-profile rounded-circle mx-auto mb-2"
				th:src="${member.image} != null ? ${member.image} : @{/img/스페이스.png}"
				alt="" style="width: 300px; height: 300px;">

		</span>
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse"
			data-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent" aria-expanded="false"
			aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link js-scroll-trigger"
					href="#"
					style="color: white; font-size: 35px; margin-bottom: 50px; margin-top: 10px;"
					th:text="${member.name}">스누피</a></li>
				<li class="nav-item"><a th:text="${categorys1}"
					class="nav-link js-scroll-trigger" href="#about"
					style="color: white; font-size: 25px; font-weight: normal;margin-bottom : 10px">프로필</a>
				</li>
				<li class="nav-item"><a th:text="${categorys2}"
					class="nav-link js-scroll-trigger" href="#experience"
					style="color: white; font-size: 25px; font-weight: normal;margin-bottom : 10px">프로젝트</a>
				</li>
				<li class="nav-item"><a th:text="${categorys3}"
					class="nav-link js-scroll-trigger" href="#education"
					style="color: white; font-size: 25px; font-weight: normal;margin-bottom : 10px">대외활동</a>
				</li>
				<li class="nav-item"><a th:text="${categorys4}"
					class="nav-link js-scroll-trigger" href="#skills"
					style="color: white; font-size: 25px; font-weight: normal;margin-bottom : 10px">수상자격
						/ 자격증</a></li>
				<li class="nav-item"><a th:text="${categorys5}"
					class="nav-link js-scroll-trigger" href="#interests"
					style="color: white; font-size: 25px; font-weight: normal;margin-bottom : 10px">보유기술</a>
				</li>
			</ul>
		</div>
	</nav>

	<div class="container-fluid p-0"
		style="margin-left: 100px; width: 1500px;">
		
		<div th:if="${#strings.equals(spaceId, memMember.spaceId)} or ${#strings.equals(member.AllPublicYn, 'Y')}" >
			<!-- 내용을 확인하려면 계정의 ID와 로그인한 ID가 동일하거나 스페이스 전체 공개 -->
			<!-- 상단 사이드바 -->
			<div class="floBanPc1 hidden-md hidden-sm hidden-xs" th:if="${#strings.equals(spaceId, memMember.spaceId)}">
				<button type="button" class="btn btn-secondary dropdown-toggle"
					data-bs-toggle="dropdown" aria-expanded="false"
					style="padding: 0px; background-color: transparent; border: none;">
					<img src="/img/rightTopLogo.png" style="width: 76px; height: 76px">
				</button>
				<ul class="dropdown-menu">
					<li><a class="dropdown-item" href="/mypage/write">작성하기</a></li>
					<li><a class="dropdown-item" href="/mypage/main">마이페이지</a></li>
					<li><a class="dropdown-item" href="/members/logout">백스페이스</a></li>
				</ul>
			</div>

			<!-- 하단 사이드바 -->
			<div class="floBanPc2 hidden-md hidden-sm hidden-xs" th:if="${#strings.equals(spaceId, memMember.spaceId)}">
				<button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" style="padding: 0px; background-color: transparent; border: none;">
					<img src="/img/rightBottomLogo.png" style="width: 80px; height: 80px">
				</button>
				<ul class="dropdown-menu">
					<li><a class="dropdown-item" onclick="kakaoShare()">카카오톡 공유하기</a></li>
					<li><a class="dropdown-item"  id="savePdf">PDF 내보내기</a></li>

				</ul>
			</div>
			<!-- 로딩바 -->
			<div class="text-center loading">
				<div class="spinner-border" role="status">
					<span class="sr-only">Loading...</span>
				</div>
			</div>

			<div id="pdfDiv">
			<section class="resume-section p-3 p-lg-5 d-flex d-column pdf_page" id="about">
				<div class="my-auto" >
					<h2 class="mb-5 space-title category-top-margin" th:text="${categorys1}">프로필</h2>

					<div th:each="vo : ${spaceLists}" th:if="${vo.type} == ${categorys1}">
						<p th:text="${vo.title}" style="font-size:30px; color:black;">-</p>
						<div th:utext="${vo.content}" style="color: black"></div>
						<br><br><br>
					</div>
				</div>
			</section>

			<section class="resume-section p-3 p-lg-5 d-flex flex-column pdf_page" id="experience">
				<div class="my-auto">
					<h2 class="mb-5 space-title" th:text="${categorys2}">프로젝트</h2>

					<div th:each="vo : ${spaceLists}" th:if="${vo.type} == ${categorys2}">
						<p th:text="${vo.title}" style="font-size:30px; color:black;">-</p>
						<div th:utext="${vo.content}" style="color: black"></div>
						<br><br><br>
					</div>

				</div>

			</section>

			<section class="resume-section p-3 p-lg-5 d-flex flex-column pdf_page"
				id="education">
				<div class="my-auto">
					<h2 class="mb-5 space-title" th:text="${categorys3}">대외활동</h2>


					<div th:each="vo : ${spaceLists}" th:if="${vo.type} == ${categorys3}">
						<p th:text="${vo.title}" style="font-size:30px; color:black;">-</p>
						<div th:utext="${vo.content}" style="color: black"></div>
						<br><br><br>
					</div>

				</div>
			</section>

			<section class="resume-section p-3 p-lg-5 d-flex flex-column pdf_page"
				id="skills">
				<div class="my-auto">
					<h2 class="mb-5 space-title" th:text="${categorys4}">수상자격 / 자격증</h2>

					<div th:each="vo : ${spaceLists}" th:if="${vo.type} == ${categorys4}">
						<p th:text="${vo.title}" style="font-size:30px; color:black;">-</p>
						<div th:utext="${vo.content}" style="color: black"></div>
						<br><br><br>
					</div>
				</div>
			</section>

			<section class="resume-section p-3 p-lg-5 d-flex flex-column pdf_page"
				id="interests">
				<div class="my-auto">
					<h2 class="mb-5 space-title" th:text="${categorys5}">보유기술</h2>
					<div th:each="vo : ${spaceLists}" th:if="${vo.type} == ${categorys5}">
						<p th:text="${vo.title}" style="font-size:30px; color:black;">-</p>
						<div th:utext="${vo.content}" style="color: black"></div>
						<br><br><br>
					</div>
				</div>
			</section>




			</div>
		</div>
		<div
			th:if="!(${#strings.equals(spaceId, memMember.spaceId)}) and ${#strings.equals(member.AllPublicYn, 'N')}">
			<!-- th:uless="${#strings.equals(spaceId, memMember.spaceId)} or ${#strings.equals(member.AllPublicYn, 'Y')}">-->
			<p
				style="margin-top: 400px; margin-left: 350px; margin-bottom: 35px; font-weight: bold; font-size: 52px;">
				공개되지 않은 스페이스입니다.</p>
		</div>
	</div>

	<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
	<script th:inline="javascript">

		var memberImage = /*[[ ${member.image} ]]*/
		var memberName = /*[[ ${member.name} ]]*/
		var memberSpaceId = /*[[ ${member.spaceId} ]]*/
		var hitCount = /*[[ ${hitCount} ]]*/


		$(document).ready(function() {
			/**
			 * PDF 내보내기
			 */

			$('#savePdf').click(function() { // pdf저장 button id

				$('.text-center').css("display","block");

				// setTImeout을 하는 이유는 html2canvas를 불러오는게 너무 빨라서 앞의 js가 먹혀도 반영되지 않은 것처럼 보임
				setTimeout(function() {
					createPdf();
				}, 5000);

			});

			function createPdf() { //이미지를 pdf로 만들기
				html2canvas($('#pdfDiv')[0]).then(function(canvas) { //저장 영역 div id

					// 캔버스를 이미지로 변환
					var imgData = canvas.toDataURL('image/jpeg');

					var imgWidth = 210; // 이미지 가로 길이(mm) / A4 기준 210mm
					var pageHeight = imgWidth * 1.414;  // 출력 페이지 세로 길이 계산 A4 기준
					var imgHeight = canvas.height * imgWidth / canvas.width;
					var heightLeft = imgHeight;
					var margin = 20; // 출력 페이지 여백설정
					var doc = new jsPDF('p', 'mm');
					var position = 0;

					// 첫 페이지 출력
					doc.addImage(imgData, 'jpeg', margin, position, imgWidth, imgHeight);
					heightLeft -= pageHeight;

					// 한 페이지 이상일 경우 루프 돌면서 출력
					while (heightLeft >= 20) {
						position = heightLeft - imgHeight;
						doc.addPage();
						doc.addImage(imgData, 'jpeg', margin, position, imgWidth, imgHeight);
						heightLeft -= pageHeight;
					}

					// 파일 저장
					doc.save(memberName + '_포트폴리오.pdf');
					$('.text-center').css("display","none");
				});
			}

		})

		/**
		 * 카카오톡 공유하기
		 */
		function kakaoShare() {


			// init 체크
			if (!Kakao.isInitialized()) {
				Kakao.init('8d88fe30f1babaf45150d93fec381f08');
			}

			Kakao.Link.sendDefault({
				objectType: 'feed',
				content: {
					title: memberName+'의 포트폴리오',
					description: memberName+'의 포트폴리오 입니다. 확인해주세요.',
					imageUrl: memberImage,
					link: {
						mobileWebUrl: 'http://localhost:8080/space/'+memberSpaceId,
						webUrl: 'http://localhost:8080/space/'+memberSpaceId,
					},
				},
				itemContent: {
					profileText: memberName,
					profileImageUrl: memberImage,
				},
				social: {
					likeCount: hitCount
				},
				buttons: [
					{
						title: '자세히 보기',
						link: {
							mobileWebUrl: 'http://localhost:8080/space/'+memberSpaceId,
							webUrl: 'http://localhost:8080/space/'+memberSpaceId,
						},
					},
				],
				// 카카오톡 미설치 시 카카오톡 설치 경로이동
				installTalk: true,
			})
		}



	</script>

	<!-- Bootstrap core JavaScript -->
	<script src="/space/vendor/jquery/jquery.min.js"></script>
	<script src="/space/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Plugin JavaScript -->
	<script src="/space/vendor/jquery-easing/jquery.easing.min.js"></script>

	<!-- Custom scripts for this template -->
	<script src="/space/js/resume.min.js"></script>



</body>
</html>
